# Het IMBOR meta-model: shapes
# --------------------
# The IMBOR metamodel, documented in Dutch.

PREFIX geo: <http://www.opengis.net/ont/geosparql#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX sh: <http://www.w3.org/ns/shacl#>
PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

PREFIX nen3610: <https://definities.geostandaarden.nl/def/nen3610#>
PREFIX nta8035: <https://w3id.org/def/basicsemantics-owl#>
PREFIX shape: <http://linkeddata.crow.nl/imbor/def/shape/>
PREFIX graph: <http://linkeddata.crow.nl/imbor/def/graph/>

# NodeShapes: Physical object
# ----------
# De eigenschappen zijn niet met blanco's gekoppeld, zodat ze met sh:deactivated
# overruled kunnen worden.
# Noot: de meeste Shapes zitten in IMBOR zelf.

shape:Nta8035FysiekObject
  a sh:NodeShape ;
  sh:name "Physical Object" ;
  sh:targetClass nta8035:PhysicalObject ;

  sh:property shape:label ;
  sh:property shape:prefLabel ;
  sh:property shape:definition ;
  sh:property shape:PhysicalObject-hasPart ;
  sh:property shape:PhysicalObject-subClassOf ;
  .

shape:ImborEigenschappen
  a sh:NodeShape ;
  # sh:targetClass rdf:Property ;
  # ^^ bovenstaande ^^ richt zich ook op rdf:Property`s die voorkomen via owl:import. 
  # Daarom is onderstaande SPARQLTarget gericht op de rdf:Property`s die via sh:path
  # worden gebruikt in de ontologie.
  sh:target [
    a sh:SPARQLTarget ;
		sh:prefixes rdf: , sh: , graph: ;
		sh:select """
			SELECT ?this
			WHERE {
        # GRAPH graph:Eigenschappen {
          ?this a rdf:Property .
        # } GRAPH graph:Shapes {
          ?propertyShape sh:path ?this .
        # }
			}
			""" ;

  ] ;

  sh:property shape:label ;
  sh:property shape:prefLabel ;
  sh:property shape:definition ;
  .

shape:Nta8035EnumeratieTypes
  a sh:NodeShape ;
  sh:targetClass nta8035:EnumerationType ;

  sh:property shape:label ;
  sh:property shape:prefLabel ;
  sh:property shape:definition ;
  .

# shape:Nta

# Property Shapes: algemeen
# ---------------

shape:label
  a sh:PropertyShape ;
  sh:message "Elk fysiek object moet tenminste één Nederlands label hebben"@nl-NL ;

  sh:path rdfs:label ;
  sh:minCount 1 ;
  sh:datatype rdf:langString ;
  sh:languageIn ( "nl" ) ;
  .

shape:prefLabel
  a sh:PropertyShape ;

  sh:path skos:prefLabel ;
  sh:minCount 1 ;  # IMBOR: prefLabel moet 1x voorkomen
  sh:datatype rdf:langString ;  # NTA8035: waarde is per taal uniek
  sh:languageIn ( "nl" ) ;  # IMBOR: Er moet een Nederlands label bij zitten
  sh:uniqueLang true ;
  .

shape:definition
  a sh:PropertyShape ;

  sh:path skos:definition ;
  sh:datatype rdf:langString ;
  sh:languageIn ( "nl" ) ;
  .

# Property Shapes: fysieke objecten
# ---------------

shape:PhysicalObject-hasPart
  a sh:PropertyShape ;

  sh:path nta8035:hasPart ;
  sh:class nta8035:PhysicalObject ;
  .

shape:PhysicalObject-subClassOf
  a sh:PropertyShape ;

  sh:path rdfs:subClassOf ;
  sh:class nta8035:PhysicalObject ;
  .

# Property Shapes: geometrie
# ---------------
# Mogelijke geometrie-waardes zijn in IMBOR op objecttype-niveau bepaald.
# Objecttype-shapes worden gegenereerd in de ontologie met deze propertyshapes
# als waarde bij sh:or of sh:property.

shape:PuntGeometriePropertyShape
  a sh:PropertyShape ;
  sh:name "puntgeometrie"@nl-NL ;
  sh:description "Geometrie kan een punt zijn"@nl-NL ;
  sh:path (geo:geometry geo:asWKT) ;
  sh:datatype geo:wktLiteral ;
  sh:pattern "POINT" ;
.

shape:LijnGeometriePropertyShape
  a sh:PropertyShape ;
  sh:name "lijngeometrie"@nl-NL ;
  sh:description "Geometrie kan een lijn zijn"@nl-NL ;
  sh:path (geo:geometry geo:asWKT) ;
  sh:datatype geo:wktLiteral ;
  sh:pattern "LINESTRING" ;
.

shape:VlakGeometriePropertyShape
  a sh:PropertyShape ;
  sh:name "vlakgeometrie"@nl-NL ;
  sh:description "Geometrie kan een vlak zijn"@nl-NL ;
  sh:path (geo:geometry geo:asWKT) ;
  sh:datatype geo:wktLiteral ;
  sh:pattern "POLYGON" ;
.

shape:MultiVlakGeometriePropertyShape
  a sh:PropertyShape ;
  sh:name "multivlakgeometrie"@nl-NL ;
  sh:description "Geometrie kan een multivlak zijn"@nl-NL ;
  sh:path (geo:geometry geo:asWKT) ;
  sh:datatype geo:wktLiteral ;
  sh:pattern "MULTIPOLYGON" ;
.
